<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sensitivity analyses • SticsOnR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Sensitivity analyses">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">SticsOnR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/archives/Introduction_to_sticRs.html">Introduction to SticsOnR</a>
    </li>
    <li>
      <a href="../../articles/archives/Sensitivity_analyses.html">Sensitivity analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SticsRPacks/SticsOnR">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Sensitivity analyses</h1>
                        <h4 class="author">Rémi Vezy</h4>
            
            <h4 class="date">2019-11-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/SticsRPacks/SticsOnR/blob/master/vignettes/archives/Sensitivity_analyses.Rmd"><code>vignettes/archives/Sensitivity_analyses.Rmd</code></a></small>
      <div class="hidden name"><code>Sensitivity_analyses.Rmd</code></div>

    </div>

    
    
<div id="sensitivity-analyses" class="section level2">
<h2 class="hasAnchor">
<a href="#sensitivity-analyses" class="anchor"></a>Sensitivity analyses</h2>
<p>Sensitivity analyses are critical steps for model evaluation. This step is often complicated because it is hard to implement and hard to understand. One purpose of the <a href="https://github.com/SticsRPacks/SticsOnR">SticsOnR</a> package is to make this step easy by abstracting all the complex code and reduce it to only one main function. Currently, the package supports two different and well known algorithms: fast99 and sobol. Both functions come from the excellent <a href="https://cran.r-project.org/web/packages/sensitivity/index.html">sensitivity</a> package. The function is simply called <code>sensitive_stics</code>, and make automatic sensitivity analyses of any STICS output variable to any given number of parameter.</p>
</div>
<div id="doe" class="section level2">
<h2 class="hasAnchor">
<a href="#doe" class="anchor"></a>DOE</h2>
<p>The design of experiment, or DOE, is a sample of parameter values that will be tested during the sensitivity analysis. If the user wants to study the interaction between several parameters, the DOE will be a data.frame with parameters in column and their values in rows. The values are sampled using <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/Distributions">distribution functions</a>, such as the <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/Uniform">uniform distribution</a> or the <a href="https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/Normal">normal distribution</a>. In <code>sensitive_stics</code>, the DOE is always computed using the fast99 function.</p>
<p>Here is the first four rows of an example DOE to study the intercations between the interrow and the sowing density:</p>
<pre><code>#&gt; Registered S3 method overwritten by 'sensitivity':
#&gt;   method    from 
#&gt;   print.src dplyr</code></pre>
<table class="table">
<thead><tr class="header">
<th align="right">interrang</th>
<th align="right">P_densitesem</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.1500000</td>
<td align="right">210</td>
</tr>
<tr class="even">
<td align="right">0.1957143</td>
<td align="right">214</td>
</tr>
<tr class="odd">
<td align="right">0.2414286</td>
<td align="right">218</td>
</tr>
<tr class="even">
<td align="right">0.2128571</td>
<td align="right">222</td>
</tr>
</tbody>
</table>
</div>
<div id="description-and-parameterization" class="section level2">
<h2 class="hasAnchor">
<a href="#description-and-parameterization" class="anchor"></a>Description and parameterization</h2>
<p>Here is an example of a <code>sensitive_stics</code> call for the previous example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"SticsOnR"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">sens=<span class="st"> </span><span class="kw">sensitive_stics</span>(<span class="dt">dir.orig =</span> <span class="st">"0-Data"</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">                      <span class="dt">dir.targ =</span> <span class="st">"2-Simulations"</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">                      <span class="dt">stics =</span> <span class="st">"0-Data/stics_executable/stics.exe"</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">                      <span class="dt">obs_name =</span> <span class="st">"Wheat.obs"</span>,</a>
<a class="sourceLine" id="cb2-6" title="6">                      <span class="dt">Vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lai(n)"</span>, <span class="st">"masec(n)"</span>),</a>
<a class="sourceLine" id="cb2-7" title="7">                      <span class="dt">Parameters =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">interrang=</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">min =</span> <span class="fl">0.05</span>, <span class="dt">max =</span> <span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb2-8" title="8">                                        <span class="dt">P_densitesem=</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">min =</span> <span class="dv">140</span>, <span class="dt">max =</span> <span class="dv">280</span>)),</a>
<a class="sourceLine" id="cb2-9" title="9">                      <span class="dt">method =</span> <span class="st">"fast99"</span>, <span class="dt">n =</span> <span class="dv">70</span>, <span class="dt">q =</span> <span class="st">"qunif"</span>)</a></code></pre></div>
<p>The function will use the STICS inputs located in “0-Data”, use the STICS executable located in “0-Data/stics_executable/stics.exe”, and execute the simulations in automatically generated sub-folders in “2-Simulations”. The function will test the sensitivity of the leaf area index (<code>lai(n)</code>) and the above-ground dry mass (<code>masec(n)</code>) variables to the interrow (<code>interrang</code>) and the sowing density (<code>P_densitesem</code>) parameters. The parameter values are sampled using a uniform distribution (its quantile function name is provided: “qunif”) with a minimum value of 0.05 and 140 and a maximum of 0.25 and 280 for the interrow and the sowing density respectively. The fast99 algorithm will be used to perform the sensitivty analysis with 70 simulations.</p>
<p>If a parameter distribution is closer to a normal distibution, which is often the case in reality, the user should set the <code>q</code> parameter to “qnorm” instead to better sample plausible values of the parameter. If so, the user should also replace the parameter arguments (min and max) and values that correspond to <code>qunif</code> arguments by the arguments of the <code>qnorm</code> function, such as:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"SticsOnR"</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">sens=<span class="st"> </span><span class="kw">sensitive_stics</span>(<span class="dt">dir.orig =</span> <span class="st">"0-Data"</span>,</a>
<a class="sourceLine" id="cb3-3" title="3">                      <span class="dt">dir.targ =</span> <span class="st">"2-Simulations"</span>,</a>
<a class="sourceLine" id="cb3-4" title="4">                      <span class="dt">stics =</span> <span class="st">"0-Data/stics_executable/stics.exe"</span>,</a>
<a class="sourceLine" id="cb3-5" title="5">                      <span class="dt">obs_name =</span> <span class="st">"Wheat.obs"</span>,</a>
<a class="sourceLine" id="cb3-6" title="6">                      <span class="dt">Vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lai(n)"</span>, <span class="st">"masec(n)"</span>),</a>
<a class="sourceLine" id="cb3-7" title="7">                      <span class="dt">Parameters =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">interrang=</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">mean =</span> <span class="fl">0.15</span>, <span class="dt">sd =</span> <span class="fl">0.05</span>),</a>
<a class="sourceLine" id="cb3-8" title="8">                                        <span class="dt">P_densitesem=</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">mean =</span> <span class="dv">210</span>, <span class="dt">sd =</span> <span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb3-9" title="9">                      <span class="dt">method =</span> <span class="st">"fast99"</span>, <span class="dt">n =</span> <span class="dv">70</span>, <span class="dt">q =</span> <span class="st">"qnorm"</span>)</a></code></pre></div>
</div>
<div id="run-with-caution" class="section level2">
<h2 class="hasAnchor">
<a href="#run-with-caution" class="anchor"></a>Run with caution</h2>
<p>The sensitivity analysis is performed by running a STICS simulation with input parameter(s) values taken from each row of the DOE. As the number of simulations required to perform a sensitivity analysis on several parameters can be gigantic, the function make the simulations in parallel using all cores minus one from the computer to reduce computation time, and delete each simulation files and folders recursively as soon as its results are imported in R to reduce disk occupation. However, if R or the computer crashes during the sensitivity analysis, all results would be lost if <code>Erase= T</code> (as they were continuously erased). There is an argument to disable the deleting (<code>Erase</code>), but the user should proceed with care as the disk space occupied by the simulations can grow very rapidly.</p>
</div>
<div id="outputs" class="section level2">
<h2 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h2>
<p><code>sensitive_stics</code> returns a list of three objects:</p>
<ul>
<li>gg_objects: A list of ggplot objects to plot the sensitivity of each variable to the parameter(s)</li>
<li>sensi_objects: A list of the sensitivity analysis output, <em>e.g.</em> a list of class <code>fast99</code> for the <code>fast99</code> method.</li>
<li>DOE: A list of the design of experiment, with parameter values used for each simulation.</li>
</ul>
<p>Here is the ggplot2 object for the leaf area index from our previous example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">sens<span class="op">$</span>gg_objects<span class="op">$</span><span class="st">`</span><span class="dt">lai(n)</span><span class="st">`</span></a></code></pre></div>
<div class="figure">
<img src="sensitivity_lai.png" alt="Figure 1: Sensitivity analysis output" width="100%"><p class="caption">
Figure 1: Sensitivity analysis output
</p>
</div>
<p>The plot is not very usefull as it is. It only tell us that the leaf area index seems to be sensitive to the variability of the parameters values. These results are only interesting when coupled with the <code>sensi_objects</code> outputs, but they also can be improved if rendered interactively, for exemple using <code><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html">plotly::ggplotly</a></code>.</p>
</div>
<div id="save-load" class="section level2">
<h2 class="hasAnchor">
<a href="#save-load" class="anchor"></a>Save / Load</h2>
<p>The sensitivity object can be easily saved on disk using the <code>save_sensi</code> function, and then reloaded using <code>load_sensi</code>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#sensitivity-analyses">Sensitivity analyses</a></li>
      <li><a href="#doe">DOE</a></li>
      <li><a href="#description-and-parameterization">Description and parameterization</a></li>
      <li><a href="#run-with-caution">Run with caution</a></li>
      <li><a href="#outputs">Outputs</a></li>
      <li><a href="#save-load">Save / Load</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Remi Vezy, SticsRPacks.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
